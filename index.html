<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Ultra Smooth Neon Snake</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif;}
body{display:flex;justify-content:center;align-items:center;height:100vh;background:#111;overflow:hidden;}
.animated-bg{position:absolute;width:200%;height:200%;background:linear-gradient(120deg,#222,#333,#444,#555);background-size:400% 400%;animation:moveBg 25s linear infinite;z-index:-1;}
@keyframes moveBg{0%{background-position:0% 0%;}50%{background-position:100% 100%;}100%{background-position:0% 0%;}}
.game-container{position:relative;width:90vmin;height:90vmin;border:4px solid #555;border-radius:12px;background:#111;box-shadow:0 0 20px #000 inset;}
canvas{display:block;border-radius:12px;background:#111;}
.score{position:absolute;top:-8%;font-size:4vw;font-weight:bold;color:#0ff;text-shadow:0 0 10px #0ff,0 0 20px #0ff;}
.overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);color:#fff;font-size:8vw;font-weight:bold;display:flex;justify-content:center;align-items:center;flex-direction:column;border-radius:12px;display:none;cursor:pointer;}
.overlay button{margin-top:5vw;padding:2vw 4vw;font-size:4vw;cursor:pointer;background:#0ff;border:none;border-radius:6px;color:#111;transition:0.3s;}
.overlay button:hover{background:#0aa;}
#difficultyScreen{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);color:#0ff;font-size:6vw;display:flex;justify-content:center;align-items:center;flex-direction:column;border-radius:12px;}
#difficultyScreen button{margin:1vw;padding:2vw 4vw;font-size:4vw;cursor:pointer;background:#0ff;border:none;border-radius:6px;color:#111;}
#difficultyScreen button:hover{background:#0aa;}
.controls{position:absolute;right:-22%;top:50%;transform:translateY(-50%);display:flex;flex-direction:column;gap:5%;pointer-events:none;}
.control-btn{width:16vw;max-width:70px;aspect-ratio:1/1;background:#0ff;border-radius:50%;display:flex;justify-content:center;align-items:center;color:#111;font-weight:bold;font-size:5vw;pointer-events:auto;user-select:none;}
</style>
</head>
<body>
<div class="animated-bg"></div>
<div class="game-container">
    <div class="score">Score: 0</div>
    <canvas id="gameCanvas"></canvas>
    <div class="overlay" id="gameOver">
        <div>Game Over!</div>
        <button onclick="restartGame()">Restart</button>
    </div>
    <div id="difficultyScreen">
        <div>Select Difficulty</div>
        <button onclick="startGame('Easy')">Easy</button>
        <button onclick="startGame('Medium')">Medium</button>
        <button onclick="startGame('Hard')">Hard</button>
    </div>
</div>
<!-- Controls on side -->
<div class="controls">
    <div class="control-btn" id="up">↑</div>
    <div class="control-btn" id="left">←</div>
    <div class="control-btn" id="down">↓</div>
    <div class="control-btn" id="right">→</div>
</div>

<script>
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
const overlay=document.getElementById('gameOver');
const scoreDisplay=document.querySelector('.score');
const difficultyScreen=document.getElementById('difficultyScreen');

let box, snake=[], food, direction, score, speed, lastTime=0, moveAccumulator=0;

// ===== Subtle "eat" sound only =====
const audioCtx = new (window.AudioContext||window.webkitAudioContext)();
function playBeep(freq=440,duration=0.1,vol=0.2){
    const osc=audioCtx.createOscillator();
    const gain=audioCtx.createGain();
    osc.frequency.value=freq;
    osc.type="sine";
    gain.gain.value=vol;
    osc.connect(gain); gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime+duration);
}
// ==================================

function resizeCanvas(){
    let size=Math.min(window.innerWidth*0.9,window.innerHeight*0.9);
    canvas.width=size;
    canvas.height=size;
    box=Math.floor(size/25); // smaller boxes = zoomed out
}
window.addEventListener('resize',resizeCanvas);
resizeCanvas();

function startGame(level){
    difficultyScreen.style.display='none';
    if(level==='Easy') speed=150;
    if(level==='Medium') speed=100;
    if(level==='Hard') speed=70;
    initGame();
}

function initGame(){
    snake=[{x:5*box,y:5*box}];
    direction='RIGHT';
    score=0;
    scoreDisplay.textContent='Score: 0';
    food=spawnFood();
    overlay.style.display='none';
    lastTime=0;
    moveAccumulator=0;
    requestAnimationFrame(gameLoop);
}

function spawnFood(){
    let newFood;
    do{
        newFood={x:Math.floor(Math.random()*(canvas.width/box))*box,
                 y:Math.floor(Math.random()*(canvas.height/box))*box};
    }while(snake.some(seg=>seg.x===newFood.x && seg.y===newFood.y));
    return newFood;
}

function draw(){
    ctx.fillStyle='#111';
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // Snake
    snake.forEach((seg,i)=>{
        let grad=ctx.createLinearGradient(seg.x,seg.y,seg.x+box,seg.y+box);
        grad.addColorStop(0,'#0cc'); grad.addColorStop(1,'#00f');
        ctx.fillStyle=grad;
        ctx.beginPath();
        ctx.arc(seg.x+box/2,seg.y+box/2,box/2,0,Math.PI*2);
        ctx.fill();
    });

    // Head glow
    let head=snake[0];
    ctx.fillStyle='#0ff';
    ctx.shadowColor='#0ff';
    ctx.shadowBlur=20;
    ctx.beginPath();
    ctx.arc(head.x+box/2,head.y+box/2,box/2,0,Math.PI*2);
    ctx.fill();
    ctx.shadowBlur=0;

    // Food
    let fGrad=ctx.createRadialGradient(food.x+box/2,food.y+box/2,2,food.x+box/2,food.y+box/2,box);
    fGrad.addColorStop(0,'#f0f'); fGrad.addColorStop(1,'rgba(255,0,255,0)');
    ctx.fillStyle=fGrad;
    ctx.shadowColor='#f0f';
    ctx.shadowBlur=15;
    ctx.beginPath();
    ctx.arc(food.x+box/2,food.y+box/2,box/2,0,Math.PI*2);
    ctx.fill();
    ctx.shadowBlur=0;
}

function update(deltaTime){
    moveAccumulator+=deltaTime;
    if(moveAccumulator>=speed){
        moveSnake();
        moveAccumulator=0;
    }
}

function moveSnake(){
    let head={x:snake[0].x,y:snake[0].y};
    if(direction==='LEFT') head.x-=box;
    if(direction==='RIGHT') head.x+=box;
    if(direction==='UP') head.y-=box;
    if(direction==='DOWN') head.y+=box;

    // Collision
    if(head.x<0||head.x>=canvas.width||head.y<0||head.y>=canvas.height||snake.some(seg=>seg.x===head.x&&seg.y===head.y)){
        gameOver(); return;
    }

    snake.unshift(head);

    // Eat food
    if(head.x===food.x&&head.y===food.y){
        score+=10;
        scoreDisplay.textContent='Score: '+score;
        food=spawnFood();
        playBeep(600,0.1,0.15); // beep only on eat
    }else{
        snake.pop();
    }
}

function gameLoop(timestamp){
    if(!lastTime) lastTime=timestamp;
    let deltaTime=timestamp-lastTime;
    lastTime=timestamp;
    update(deltaTime);
    draw();
    requestAnimationFrame(gameLoop);
}

// PC Controls
document.addEventListener('keydown',e=>{
    if((e.key==='ArrowLeft'||e.key==='a')&&direction!=='RIGHT') direction='LEFT';
    if((e.key==='ArrowRight'||e.key==='d')&&direction!=='LEFT') direction='RIGHT';
    if((e.key==='ArrowUp'||e.key==='w')&&direction!=='DOWN') direction='UP';
    if((e.key==='ArrowDown'||e.key==='s')&&direction!=='UP') direction='DOWN';
});

// Mobile touch buttons
document.getElementById('up').addEventListener('touchstart',()=>{if(direction!=='DOWN') direction='UP';});
document.getElementById('down').addEventListener('touchstart',()=>{if(direction!=='UP') direction='DOWN';});
document.getElementById('left').addEventListener('touchstart',()=>{if(direction!=='RIGHT') direction='LEFT';});
document.getElementById('right').addEventListener('touchstart',()=>{if(direction!=='LEFT') direction='RIGHT';});

// Swipe controls
let touchStartX=0,touchStartY=0;
canvas.addEventListener('touchstart',e=>{
    const t=e.touches[0];
    touchStartX=t.clientX;
    touchStartY=t.clientY;
});
canvas.addEventListener('touchend',e=>{
    const t=e.changedTouches[0];
    let dx=t.clientX-touchStartX;
    let dy=t.clientY-touchStartY;
    if(Math.abs(dx)>Math.abs(dy)){
        if(dx>30 && direction!=='LEFT') direction='RIGHT';
        else if(dx<-30 && direction!=='RIGHT') direction='LEFT';
    }else{
        if(dy>30 && direction!=='UP') direction='DOWN';
        else if(dy<-30 && direction!=='DOWN') direction='UP';
    }
});

function gameOver(){
    overlay.style.display='flex';
}

// Tap anywhere on overlay to restart
overlay.addEventListener('click', restartGame);

function restartGame(){ 
    difficultyScreen.style.display='flex'; 
    overlay.style.display='none'; 
}
</script>
</body>
</html>
